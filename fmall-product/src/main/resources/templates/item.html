<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/static/item/scss/shop.css"/>
    <link rel="stylesheet" type="text/css" href="/static/item/scss/jd.css"/>
    <link rel="stylesheet" href="/static/item/scss/header.css"/>
    <link rel="stylesheet" type="text/css" href="/static/item/bootstrap/css/bootstrap.css"/>
</head>
<body>
<div id="max">
    <header>
        <!--品牌官方网站-->
        <div class="min">
            <ul class="header_ul_right">
                <li style="width:100px;">
                    <a th:if="${session.loginUser != null}" class="aa" style="width: 100px">欢迎：[[${session.loginUser.nickname}]]</a>
                    <a th:if="${session.loginUser == null}" href="http://auth.fmall.com/login.html"
                       class="aa">你好，请登录</a>
                </li>
                <li th:if="${session.loginUser == null}"><a href="http://auth.fmall.com/reg.html"  style="color: red;">免费注册</a>
                </li>
                <li><a href="http://member.fmall.com/memberOrder.html" class="aa">我的订单</a></li>
                </li>
            </ul>
        </div>
    </header>
    <nav>
        <div class="nav_min">
            <div class="nav_top">
                <div class="nav_top_one"><a href="http://fmall.com"><img src="/static/item/img/111.png"/></a></div>
                <div class="nav_top_two"><input type="text"/>
                    <button>搜索</button>
                </div>
                <div class="nav_top_three"><a href="http://cart.fmall.com/cart.html">我的购物车</a><span class="glyphicon glyphicon-shopping-cart"></span>
                </div>
            </div>
        </div>
    </nav>

</div>
<div class="Shop">
    <div class="box">
        <div class="box-one ">
            <div class="boxx">

                <div class="imgbox">
                    <div class="probox">
                        <img class="img1" alt="" th:src="${item.skuInfo.skuDefaultImg}">
                        <div class="hoverbox"></div>
                    </div>
                    <div class="showbox">
                        <img class="img1" alt="" th:src="${item.skuInfo.skuDefaultImg}">
                    </div>
                </div>

                <div class="box-lh">
                    <div class="box-lh-one">
                        <ul>
                            <li th:each="img : ${item.skuImages}" th:if="${!#strings.isEmpty(img.imgUrl)}"><img
                                    th:src="${img.imgUrl}"/></li>
                        </ul>
                    </div>
                    <div id="left">
                        <
                    </div>
                    <div id="right">
                        >
                    </div>
                </div>
            </div>
            <div class="box-two">
                <div class="box-name" th:text="${item.skuInfo.skuTitle}">
                    华为 HUAWEI Mate 10 6GB+128GB 亮黑色 移动联通电信4G手机 双卡双待
                </div>
                <div class="box-hide" th:text="${item.skuInfo.skuSubtitle}">预订用户预计11月30日左右陆续发货！麒麟970芯片！AI智能拍照！
                    <a href="/static/item/"><u>华为 HUAWEI Mate 10 Pro 10:08 限时限量抢！</u></a>
                </div>
                <div class="box-yuyue">
                    <div class="yuyue-one">
                        <img src="/static/item/img/7270ffc3baecdd448958f9f5e69cf60f.png" alt=""/> 预约抢购
                    </div>
                    <!--<div class="yuyue-two">
                        <ul>
                            <li>
                                <img src="/static/item/img/36860afb69afa241beeb33ae86678093.png"/> 秒杀结束时间
                            </li>
                        </ul>
                    </div>-->
                </div>
                <div class="box-summary clear">
                    <ul>
                        <li>价格</li>
                        <li>
                            <span>￥</span>
                            <span th:text="${#numbers.formatDecimal(item.skuInfo.price,1,2)}">4499.00</span>
                        </li>
                        <li style="color: red" th:if="${item.seckillInfo!=null}">
                            <span th:if="${#dates.createNow().getTime() < item.seckillInfo.startTime}">
                                商品将在[[${#dates.format(new java.util.Date(item.seckillInfo.startTime),"yyyy-MM-dd HH:mm:ss")}]]进行秒杀
                            </span>
                            <span th:if="${#dates.createNow().getTime() >= item.seckillInfo.startTime && #dates.createNow().getTime() <= item.seckillInfo.endTime}">
                                秒杀价：[[${#numbers.formatDecimal(item.seckillInfo.seckillPrice,1,2)}]]
                            </span>
                        </li>
                        <li>
                        </li>
                    </ul>
                </div>
                <div class="box-wrap clear">
                    <div class="box-wrap-one clear">
                        <ul>
                            <li>增值业务</li>
                            <li><img src="/static/item/img/90a6fa41d0d46b4fb0ff6907ca17c478.png"/></li>
                            <li><img src="/static/item/img/1f80c3d6fabfd3418e54b005312c00b5.png"/></li>
                        </ul>
                    </div>
                </div>
                <div class="box-attr-3">
                    <div class="box-attr clear" th:each=" attr : ${item.saleAttr}">
                        <dl>
                            <dt>选择[[${attr.attrName}]]</dt>
                            <dd th:each="vals : ${attr.attrValues}">
                                <a th:attr="skus=${vals.skuIds},class=${#lists.contains(#strings.listSplit(vals.skuIds,','),item.skuInfo.skuId.toString())?'sku_attr_value checked':'sku_attr_value'}">
                                    [[${vals.attrValue}]]
                                </a>
                            </dd>
                        </dl>
                    </div>
                </div>

                <div class="box-btns clear">
                    <div class="box-btns-one">
                        <input type="text" name="" id="numInput" value="1"/>
                        <div class="box-btns-one1">

                            <div>
                                <button id="jia">
                                    +
                                </button>
                            </div>
                            <div>
                                <button id="jian">
                                    -
                                </button>
                            </div>

                        </div>
                    </div>
                    <div class="box-btns-two" th:if="${item.seckillInfo != null && (#dates.createNow().getTime() >= item.seckillInfo.startTime && #dates.createNow().getTime() <= item.seckillInfo.endTime)}">
                        <a href="#" id="sekillA" th:attr="skuId=${item.skuInfo.skuId},sessionId=${item.seckillInfo.promotionSessionId},code =${item.seckillInfo.randomCode}">
                           立即抢购
                        </a>
                    </div>
                    <div class="box-btns-two" th:if="${item.seckillInfo == null || (#dates.createNow().getTime() < item.seckillInfo.startTime || #dates.createNow().getTime() > item.seckillInfo.endTime)}">
                        <a href="#" id="addToCartA" th:attr="skuId=${item.skuInfo.skuId}">
                            加入购物车
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="ShopXiangqing">
        <div class="allLeft">
            <div class="huoreyuyue">
                <h3>火热抢购</h3>
            </div>
            <div class="dangeshopxingqing">
                <ul class="shopdange">
                    <li>
                        <a><img style="width: 150px;height: 150px" th:src="${item.skuInfo.skuDefaultImg}"/></a>
                        <p>
                            <a th:text="${item.skuInfo.skuTitle}"></a>
                        </p>
                        <p><strong class="J-p-20015341974">￥[[${#numbers.formatDecimal(item.skuInfo.price,1,2)}]]</strong></p>
                    </li>
                </ul>
            </div>
        </div>
        <!--商品介绍-->
        <div class="allquanbushop">
            <ul class="shopjieshao">
                <li class="jieshoa" style="background: #e4393c;">
                    <a style="color: white;">商品介绍</a>
                </li>
                <li class="baozhuang">
                    <a>规格与包装</a>
                </li>
            </ul>
            <!--商品详情-->
            <div class="huawei">
                <ul class="xuanxiangka">
                    <li class="jieshoa actives" id="li1">
                        <div class="shanpinsssss">
                            <img class="xiaoguo" th:each="desc : ${#strings.listSplit(item.desc.decript,',')}"
                                 th:src="${desc}"/>
                        </div>
                    </li>
                    <li class="baozhuang actives" id="li2">
                        <div class="guiGebox">
                            <div class="guiGe" th:each="group : ${item.groupAttrs}">
                                <h3 th:text="${group.groupName}">主体</h3>
                                <dl>
                                    <div th:each="attr : ${group.attrs}">
                                        <dt th:text="${attr.attrName}">品牌</dt>
                                        <dd th:text="${attr.attrValue}">华为(HUAWEI)</dd>
                                    </div>
                                </dl>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="Fixedbian">
    <ul>
        <li class="li1"><a class="aaa" href="/static/item/##">顶部</a></li>
    </ul>
</div>
</body>

<script src="/static/item/js/jquery1.9.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/item/js/js.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
    $(".sku_attr_value").click(function () {
        //1.获取到所有加了checked的属性
        $(this).addClass("clicked");
        var skus = new Array();
        var curr = $(this).attr("skus").split(",");
        //当前被点击的所有sku组合放入数组
        skus.push(curr);
        //去掉同一行的所有的checked
        $(this).parent().parent().find(".sku_attr_value").removeClass("checked");
        $("a[class='sku_attr_value checked']").each(function () {
            skus.push($(this).attr("skus").split(","));
        });
        console.log(skus);
        //2.取出交集，得到skuId
        var filterEle = skus[0];
        for (var i = 1; i < skus.length; i++) {
            filterEle = $(filterEle).filter(skus[i]);
        }
        //3.跳转
        location.href = "http://item.fmall.com/" + filterEle[0] + ".html"

    });
    $(function () {
        //border: solid 1px red
        $(".sku_attr_value").parent().css({'border': 'solid 1px #CCC'});
        $("a[class='sku_attr_value checked']").parent().css({'border': 'solid 1px red'});
    });
    $("#addToCartA").click(function () {
        var num = $("#numInput").val();
        var skuId = $(this).attr("skuId");
        location.href = "http://cart.fmall.com/addToCart?skuId=" + skuId + "&num=" + num;
        return false;
    });
    $("#sekillA").click(function () {
        var isLogin = [[${  session.loginUser != null}]];
        if(isLogin){
            var num = $("#numInput").val();
            var killId = $(this).attr("sessionId") + "_" + $(this).attr("skuId");
            var  key = $(this).attr("code");
            location.href = "http://seckill.fmall.com/kill?killId="+killId+"&key="+key+"&num="+num;
        }else {
            alert("请先登录!");
        }
        return false;
    });
</script>

</html>
